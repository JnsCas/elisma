<!DOCTYPE html>
<html>
<head>
  <title>elisma</title>

  <link rel="stylesheet" href="/assets/css/isma.css">
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script>
    let sessionId
    $(document).ready(function() {
      $("#createSessionButton").click(function() {
        $.ajax({
          url: "http://localhost:9000/api/v1/sessions",
          type: "POST",
          success: function(response) {
            sessionId = response.id
            $("#createSessionResponseTextArea").val(sessionId);
          },
          error: function(xhr) {
            $("#createSessionResponseTextArea").val("Error");
          }
        });
      });
    });

    $(document).ready(function() {
      $("#talkButton").click(function() {
        var inputValue = $("#myInput").val();

        const payload = {
          prompt: inputValue
        }
        $.ajax({
          url: "http://localhost:9000/api/v1/openai/chat-completion",
          type: "POST",
          data: JSON.stringify(payload),
          headers: {
            'x-session-id': sessionId
          },
          contentType: "application/json",
          success: function(response) {
            $("#elismaResponseTextArea").val(response);
          },
          error: function(xhr) {
            $("#elismaResponseTextArea").val("Error");
          }
        });
      });
    });
  </script>
</head>
<body>
  <div class="content">
    <h1>El IsmA</h1>
    <button id="createSessionButton">Create Session</button>
    <br>
    <textarea id="createSessionResponseTextArea" rows="1" cols="50" readonly></textarea>
    <br>
    <h2>Talk to elisma</h2>
    <input type="text" id="myInput">
    <button id="talkButton">Send</button>
    <br>
    <textarea id="elismaResponseTextArea" rows="10" cols="50" readonly></textarea>
  </div>

  <canvas id="swarm"></canvas>

  <script type="text/javascript" src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/188512/codepen-utilities.min.js"></script>
  <script type="text/javascript" src="/assets/js/brain.js"></script>
</body>
</html>
